
<div *ngIf="(modeHistoire==-1 && (transport.id==null || transport.valid==false))">
  <h3>Ce bon {{id}} a ete annule ou n'existe pas !! Veuillez contactez votre dispatch !!</h3>
  <button (click)="onFermer()" class="btn btn-link" >Fermer</button>
</div>

<div *ngIf="transport.id>0">
  <!--button (click)="onFini()" class="btn btn-link" [disabled]="(!(transport.id>0)||transport.fini)">TerminerAppel</button>         
  <button (click)="onCancel()" class="btn btn-link" [disabled]="(!(transport.id>0)||transport.fini)">AnnulerAppel</button-->
  <table>
    <tr>
      <td><button (click)="printBonDeTransport('toprint')" class="btn btn-link">Print</button></td>
      <td><button (click)="onFermer()" class="btn btn-link" >Fermer</button></td>
    </tr>
  </table>
</div>

<div id="toprint"  *ngIf="modeHistoire==-1">
  <table border='1' style="font-size: 12pt; margin-inline: 5px; width: 19cm">
    <tr>
      <td style="text-align: center; text-anchor: start; width: 22%">Heure d'Appel <br> <span>&nbsp;{{transport.dateDepart | date: 'dd-MMM-yyyy'}} - {{transport.timeCall}}</span></td>
      <td style="text-align: center; text-anchor: start; width: 20%">Repartiteur <br> <span>&nbsp;{{transport.nomDispatch}}</span></td>
      <td style="text-align: center; text-anchor: start; width: 20%">Chauffeur <br> <span>&nbsp;{{transport.nomIntervenant}}</span></td>
      <td style="text-align: center; text-anchor: start; width: 20%"># PO <br> <span>&nbsp;{{transport.numPO}}</span></td>
      <td style="text-align: center; text-anchor: start; width: 18%"># Bon <br> <span>&nbsp;{{transport.id}}</span></td>
    </tr>
    <tr>
      <th style="text-align: center; text-anchor: start; width: 22%; font-size: 13pt; background-color: darkgray">Heure Reservation <br> {{transport.dateReserve | date : 'dd-MMM-yyyy'}} - {{transport.timeResrvation}}</th>
      <td style="text-align: center; text-anchor: start; width: 20%"># Camion <br> <span>&nbsp;{{transport.camionAttribue}}</span></td>
      <td style="text-align: center; text-anchor: start; width: 20%">Type d'Equipement<br> <span>&nbsp;{{transport.typeCamion}}</span></td>
      <td style="text-align: center; text-anchor: start;; width: 38%" colspan="2">$ Montant $ <br> <span>&nbsp;{{transport.total | number : '1.2'}}</span></td> <!--<span>&nbsp;{{transport.total | number : '1.2'}}</span>-->
    </tr>
    <!-- <tr style="border: 0px">
      <td colspan="3" style="text-align: center; text-anchor: start ">Porter au Compte : {{transport.porterAuCompte}}</td>
      <th colspan="2" style="text-align: center; text-anchor: start; font-size: 13pt; background-color: darkgray">Collecter en argent : {{transport.collecterArgent | number : '1.2'}}</th>
    </tr> -->
    <tr>
      <td colspan="5"><span style="text-decoration-line: underline">Client:</span>
        <span>&nbsp;{{transport.nomEntreprise}} <br> </span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;&nbsp;&nbsp;{{"Contact: " + transport.nomContact}}</span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;&nbsp;&nbsp;{{"- Tel: " + transport.telContact}}</span>
        <span *ngIf="transport.extTelContact.length>0" style="font-size: 11pt; font-style: italic">&nbsp;&nbsp;{{"Ext: " + transport.extTelContact}}</span>
      </td>  
    </tr>

    <tr>
      <td colspan="5">
          <span style="text-decoration-line: underline">De:</span><span>&nbsp;{{transport.origin}}</span> <br> &nbsp;
        <span style="font-size: 11pt; font-style: italic">Contact: </span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;{{transport.nomClient}}</span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;&nbsp;&nbsp;{{"- Tel: " + transport.telClient}}</span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;&nbsp;&nbsp;{{"- Tel: " + transport.telClient2em}}</span>
      </td>
    </tr>
    <tr>
      <td colspan="5">
          <span style="text-decoration-line: underline">A:</span><span>&nbsp;{{transport.destination}}</span> <br> &nbsp;
        <span style="font-size: 11pt; font-style: italic">Contact: </span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;{{transport.contactDest}}</span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;&nbsp;&nbsp;{{"- Tel: " + transport.tel1Dest}}</span>
        <span style="font-size: 11pt; font-style: italic">&nbsp;&nbsp;&nbsp;{{"- Tel: " + transport.tel2Dest}}</span>
      </td>
    </tr>
    <tr>
      <th colspan="5"style="text-align: center; text-anchor: start ">
          <span>Loads Liste</span>
      </th>
    </tr>
  </table>
  <table border='1' style="font-size: 12pt; margin-inline: 5px; width: 19cm">
    <tr *ngIf="mode==1">
      <th style="width: 10%">Quantites</th>
      <th style="width: 50%">Description</th>
      <td colspan="2" style="width: 30%">
        <table border='1' style="font-size: 11pt; margin: 0px; width: 57mm">
          <tr>
            <th colspan="3" style="text-align: center">Dimension</th>
          </tr>
          <tr>
            <td style="width: 34%">Long(pi)</td>
            <td style="width: 33%">Larg(pi)</td>
            <td style="width: 33%">Haut(pi)</td>
          </tr>
        </table>
      </td>
      <!--td>Longueur(pouce)</td><td>Largeur(pouce)</td><td>Hauteur(pouce)</td-->
      <td style="width: 10%">Poids(lb)</td>                        
    </tr>
    <tr *ngIf="mode==2">
      <th style="width: 10%">Quantites</th>
      <th style="width: 50%">Description</th>
      <td colspan="2" style="width: 30%">
        <table border='1' style="font-size: 11pt; margin: 0px; width: 57mm">
          <tr>
            <th colspan="3" style="text-align: center">Dimension</th>
          </tr>
          <tr>
            <td style="width: 34%">Long(cm)</td>
            <td style="width: 33%">Larg(cm)</td>
            <td style="width: 33%">Haut(cm)</td>
          </tr>
        </table>
      </td>
      <td style="width: 10%">Poids(kg)</td>                        
    </tr>
    <!--tr *ngIf="mode==2">
      <td>Quantites</td><td>Description</td><td>Longueur(cm)</td><td>Largeur(cm)</td><td>Hauteur(cm)</td><td>Poids(kg)</td>                        
    </tr-->
    <tr *ngFor="let load of loadDetails">
      <td style="text-align: center; width: 10%">{{load.quantity}}</td>
      <td style="width: 50%">{{load.description}}</td> 
      <td colspan="2" style="width: 30%">
        <table border='1' style="font-size: 11pt; margin: 0px; width: 57mm">
          <tr>
            <td style="width: 34%; text-align: right">{{load.longueur}}</td>
            <td style="width: 33%; text-align: right">{{load.largeur}}</td>
            <td style="width: 33%; text-align: right">{{load.hauteur}}</td>      
          </tr>
        </table>
      </td>
      <!--td>{{load.longueur}}</td>
      <td>{{load.largeur}}</td>
      <td>{{load.hauteur}}</td-->
      <td style="text-align: right; width: 10%">{{load.poids}}</td>
    </tr>
    <tr>
      <!--td>{{" "}}</td-->
      <th colspan="2" style="text-align: right; width: 60%">{{"Total longueur et poids : "}}</th> 
      <td colspan="2" style="width: 30%">
        <table border='1' style="font-size: 11pt; margin: 0px; width: 57mm">
          <tr>
            <th style="width: 34%; text-align: right">{{transport.longueur}}</th>
            <td style="width: 33%; text-align: center">{{" "}}</td>
            <td style="width: 33%; text-align: center">{{" "}}</td>      
          </tr>
        </table>
      </td>
      <th style="text-align: right; width:10%">{{transport.poids}}</th>
    </tr> 
  <!--/table-->
    <!--tr>
      <td *ngIf="transport.quantity!=null"> Quantite : {{transport.quantity}} </td>
      <td *ngIf="transport.longueur!=null"> Longueur : {{transport.longueur}} <span *ngIf="mode==1">pouce </span><span *ngIf="mode==2">cm </span></td>
      <td *ngIf="transport.largeur!=null"> Largeur : {{transport.largeur}} <span *ngIf="mode==1">pouce </span><span *ngIf="mode==2">cm </span></td>
      <td *ngIf="transport.hauteur!=null"> Hauteur : {{transport.hauteur}} <span *ngIf="mode==1">pouce </span><span *ngIf="mode==2">cm </span></td>
      <td *ngIf="transport.poids!=null"> Poids : {{transport.poids}} <span *ngIf="mode==1">lb </span><span *ngIf="mode==2">kg </span></td>
    </tr-->
    <!--tr>
      <td colspan="5">Taille de Load: &nbsp; Longueur: {{this.transport.longueur}} - largeur: {{this.transport.largeur}} - 
        hauteur: {{this.transport.hauteur}}- poids: {{this.transport.poids}} </td>
    </tr>
    <tr>
      <td>Type de Camion </td>
      <td>{{this.transport.typeCamion}}</td>
    </tr>
    <tr>
      <td>Option </td>
      <td>{{this.transport.optionDemande}}</td>
    </tr-->
  <!--table border='1' style="font-size: 11pt; margin-inline: 5px"-->  
    <tr> 
      <td colspan="5"style="text-align: left; text-anchor: start ">
          <span style="text-decoration-line: underline">Plus infos :</span> <span>&nbsp;{{transport.comments}} <br>&nbsp;</span>
      </td>
    </tr>
    <tr> 
      <td colspan="5"style="text-align: left; text-anchor: start ">
          <span style="text-decoration-line: underline">Note au Chauffeur:</span> <span>&nbsp;{{transport.driverNote}} <br>&nbsp;</span>
      </td>
    </tr>
    <!--tr>
      <td colspan="5"style="text-align: left; text-anchor: start ">
        {{transport.nomSignature}}  <span>&nbsp;
          <img [src]="transport.signature" height="100" width="250" *ngIf="transport.signature.length>0">
        <br>&nbsp;</span>
      </td>
    </tr-->
    <tr>
      <td colspan="5">
        <label for="">
          <input type="text" (change)="transport.nomSignature=$event.target.value.toUpperCase(); $event.target.value=''" name="nomSignature"
            style="width: 300px" class="form-control" placeholder="Nom de Signateur" [disabled]="transport.fini">
        </label>
        <br>
        <div class="m-signature-pad" *ngIf="!transport.signature.length>0">  
          <signature-pad #SignaturePad [options]="signaturePadOptions" (onBeginEvent)="drawStart()"
            (onEndEvent)="drawComplete()" (onSave)="saveHandler($event)">
          </signature-pad>
        </div>
        <img [src]="transport.signature" alt="Signature" *ngIf="transport.signature.length>0">
        <span *ngIf="transport.nomSignature.length>0"><br>
          NOM EN LETTRES MOULEES : &nbsp;{{transport.nomSignature}}
        </span>
        <div>
          <button (click)="clearHandler()" *ngIf="transport.nomSignature.length>0 && !transport.fini">Re-signer</button>
          <span>&nbsp;&nbsp;</span>
          <button (click)="okHandler()" *ngIf="(!transport.signature.length>0 && transport.nomSignature.length>0 && !transport.fini)">Ok</button>
        </div>
      </td>
    </tr>
  </table>
</div>
<div *ngIf="transport.imgUrl.length>0">
  <a href="{{transport.imgUrl}}" target="_blank">
    <img [src]="transport.imgUrl" alt="piece joint" class="img-responsive" width="100%" height="auto">
  </a>
</div>
  